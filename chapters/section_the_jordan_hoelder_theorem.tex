\section{The Jordan-Hölder Theorem}
\label{appendix: jordan hoelder}


\begin{conventions}
  We denote by $R$ a ring (with unit, not necessarily commutative) and by $M$ an $R$-module.
\end{conventions}


\begin{definition}
  \label{definition: filtration}
  A \emph{filtration} of $M$ is an increasing chain
  \[
                0
    =           M_0
    \modulelneq M_1
    \modulelneq M_2
    \modulelneq M_3
    \modulelneq \dotsb
    \modulelneq M_n
    =           M
  \]
  of submodules $M_i \moduleleq M$.
  The number $n$ is the \emph{length} of this filtration, and the quotients $M_i/M_{i-1}$ with $i = 1, \dotsc, n$ are its \emph{factors}.
\end{definition}


\begin{definition}
  A filtration $(M'_j)_{j=0}^{n'}$ is an \emph{refinement} of a filtration $(M_i)_{i=0}^n$ if $(M_i)_{i=0}^n$ is a subsequence of $(M'_j)_{j=0}^{n'}$.
\end{definition}


\begin{definition}
  Two filtrations $(M_i)_{i=0}^n$ and $(M'_j)_{j=0}^{n'}$ are equivalent if they have the same factors up to permutation and isomorphism, i.e.\ if $n = n'$ and there exists a bijection $\pi \colon \{1, \dotsc, n\} \to \{1, \dotsc, n'\}$ such that
  \[
          M'_{\pi(i)} / M_{\pi(i)-1}
    \cong M_i / M_{i-1}
  \]
  for all $i = 1, \dotsc, n$.
\end{definition}


\begin{remark}
  Two filtrations $(M_i)_{i=0}^n$ and $(M'_j)_{j=0}^{n'}$ are equivalent if and only if the familes $(M_i/M_{i-1})_{i=1}^n$ and $(M'_j/M_{j-1})_{j=1}^{n'}$ are the same up to reordering and isomorphism.
\end{remark}


% TODO: Add Examples.





\subsection{Schreiers Theorem}


\begin{lemma}
  \label{lemma: modularity of submodule lattice}
  Let $P \moduleleq N \moduleleq M$ be submodules.
  Then
  \[
      (P + C) \cap N
    = P + (C \cap N)
  \]
  for every submodule $C \moduleleq N$.
\end{lemma}


\begin{proof}
  For $n \in (P + C) \cap N$ we have that $n \in N$ and there exist $p \in P$, $c \in C$ with $n = p + c$.
  It then follows from $n - c = p \in P \moduleleq N$ that also $c = n - p \in N$.
  We therefore have that $c \in C \cap N$ and thus $n = p + c \in P + (C \cap N)$.
  
  It follows from $P \moduleleq P + C$ and $P \moduleleq N$ that $P \moduleleq (P + C) \cap N$, and it similarly follows from $C \cap N \moduleleq C \moduleleq P + C$ and $C \cap N \moduleleq N$ that $C \cap N \moduleleq N$.
  Together this shows that $P + (C \cap N) \moduleleq (P + C) \cap N$.
\end{proof}


\begin{remark}
  Lemma~\ref{lemma: modularity of submodule lattice} states that the lattice of submodules of $M$ is \emph{modular}.
\end{remark}


\begin{lemma}[Butterfly lemma]
  \label{lemma: butterfly lemma}
  Let $M$ be an $R$-module and let $N_1 \moduleleq N_2 \moduleleq M$ and $P_1 \moduleleq P_2 \moduleleq M$ be submodules.
  Then
  \begin{align*}
         &\,  (N_1 + P_2 \cap N_2)/(N_1 + P_1 \cap N_2)         \\
    \cong&\,  (N_2 \cap P_2)/((N_1 \cap P_2) + (N_2 \cap P_1))  \\
    \cong&\,  (P_1 + N_2 \cap P_2)/(P_1 + N_1 \cap P_2) \,.
  \end{align*}
\end{lemma}


\begin{fluff}
  The understand the name \enquote{butterfly~lemma} we can consider the Hasse diagramm of the various modules involved:
  \[
    \begin{tikzcd}[row sep = large]
        N_1 + P_2 \cap N_2
      & {}
      & P_1 + N_2 \cap P_2
      \\
        N_1 + P_1 \cap N_2
        \arrow[-, very thick]{u}
      & N_2 \cap P_2
        \arrow[-]{lu}
        \arrow[-]{ru}
      & P_1 + N_1 \cap P_2
        \arrow[-, very thick]{u}
      \\
        {}
      & (N_1 \cap P_2) + (N_2 \cap P_1)
        \arrow[-]{lu}
        \arrow[-, very thick]{u}
        \arrow[-]{ru}
      & {}
    \end{tikzcd}
  \]
  The two parallelograms form the wings of a butterfly.
  The butterfly~lemma states that the quotients associated to the three vertical edges are isomorphic.
  
  This image also explains how to prove the butterfly~lemma:
  Recall that the third isomorphism theory states that for all submodule $N', P' \moduleleq M$ we have that
  \[
          (N' + P')/P'
    \cong N'/(N' \cap P') \,,
  \]
  i.e.\ that in the Hasse diagram
  \[
    \begin{tikzcd}
        {}
      & N' + P'
      & {}
      \\
        N'
        \arrow[-,very thick]{ru}
      & {}
      & P'
        \arrow[-]{lu}
      \\
        {}
      & N' \cap P'
        \arrow[-]{lu}
        \arrow[-,very thick]{ru}
      & {}
    \end{tikzcd}
  \]
  the quotients associated to two parallel egdes are isomorphic.
\end{fluff}


\begin{proof}[Proof of the butterfly lemma]
  By the second isomorphism theorem it sufficies to show that 
  \begin{enumerate}
    \item
      \label{enumerate: butterfly left top}
      $(N_1 + P_1 \cap N_2) + (N_2 \cap P_2) = N_1 + P_2 \cap N_2$,
    \item
      \label{enumerate: butterfly left bottom}
      $(N_1 + P_1 \cap N_2) \cap (N_2 \cap P_2) = (N_1 \cap P_2) + (N_2 \cap P_1)$,
    \item
      \label{enumerate: butterfly right top}
      $(N_2 \cap P_2) + (P_1 + N_1 \cap P_2) = P_1 + N_2 \cap P_2$,
    \item
      \label{enumerate: butterfly right bottom}
      $(N_2 \cap P_2) \cap (P_1 + N_1 \cap P_2) = (N_1 \cap P_2) + (N_2 \cap P_2)$.
  \end{enumerate}
  It sufficies to show \ref*{enumerate: butterfly left top} and \ref*{enumerate: butterfly left bottom} because then \ref*{enumerate: butterfly right top} and \ref*{enumerate: butterfly right bottom} follows by switching the roles of the $N_i$ and $P_i$.
  The equality~\ref*{enumerate: butterfly left top} holds because
  \begin{align*}
     &\,  (N_1 + P_1 \cap N_2) + (N_2 \cap P_2) \\
    =&\,  N_1 + (P_1 \cap N_2) + (N_2 \cap P_2) \\
    =&\,  N_1 + (P_2 \cap N_2)                  \\
    =&\,  N_1 + P_2 \cap N_2 \,,
  \end{align*}
  and the equality~\ref*{enumerate: butterfly left top} holds because
  \begin{align*}
     &\,  (N_1 + P_1 \cap N_2) \cap (N_2 \cap P_2)    \\
    =&\,  ((N_2 \cap P_1) + N_1) \cap (N_2 \cap P_2)  \\
    =&\,  (N_2 \cap P_1) + (N_1 \cap (N_2 \cap P_2))  \\
    =&\,  (N_2 \cap P_1) + (N_1 \cap P_2) \,,
  \end{align*}
  where we used for the second equality that $N_2 \cap P_1 \moduleleq N_2 \cap P_2$ to apply Lemma~\ref{lemma: modularity of submodule lattice}.
\end{proof}


\begin{theorem}[Schreier]
  \label{theorem: Schreiers theorem}
  Every two filtration of $M$ have equivalent refinements.
\end{theorem}


\begin{proof}
  Let
  \begin{equation}
    \label{equation: Schreier starting filtration one}
                0
    =           M_0
    \modulelneq  M_1
    \modulelneq  M_2
    \modulelneq  M_3
    \modulelneq  \dotsb
    \modulelneq  M_n
    =           M
  \end{equation}
  and
  \begin{equation}
    \label{equation: Schreier starting filtration two}
                0
    =           M'_0
    \modulelneq  M'_1
    \modulelneq  M'_2
    \modulelneq  M'_3
    \modulelneq  \dotsb
    \modulelneq  M'_{n'}
    =           M
  \end{equation}
  be two filtrations of $M$.
  We refine the filtration~\eqref{equation: Schreier starting filtration one} to an increasing sequence of submodules
  \[
    \begingroup
      \renewcommand{\arraycolsep}{1pt}
      \renewcommand{\arraystretch}{1.5}
      \begin{array}{ccccccccccccc}
                    0
        &=&         M_0 + M'_0    \cap M_1
        &\moduleleq& M_0 + M'_1    \cap M_1
        &\moduleleq& \dotsb
        &\moduleleq& M_0 + M'_{n'} \cap M_1
        &(=&        M_1)
        &  &        {}
        \\
                    {}
        &=&         M_1 + M'_0    \cap M_2
        &\moduleleq& M_1 + M'_1    \cap M_2
        &\moduleleq& \dotsb
        &\moduleleq& M_1 + M'_{n'} \cap M_2
        &(=&        M_2)
        &  &        {}
        \\
                    {}
        &\vdots&    {}
        & &         {}
        & &         {}
        & &         {}
        & &         {}
        & &         {}
        \\
                    {}
        &=&         M_{n-1} + M'_0    \cap M_n
        &\moduleleq& M_{n-1} + M'_1    \cap M_n
        &\moduleleq& \dotsb
        &\moduleleq& M_{n-1} + M'_{n'} \cap M_n
        &(=&        M_n)
        &=&         M \,,
      \end{array}
    \endgroup
  \]
  and we can similarly refine the filtration~\eqref{equation: Schreier starting filtration two} to an increasing sequence of submodules
  \[
    \begingroup
      \renewcommand{\arraycolsep}{1pt}
      \renewcommand{\arraystretch}{1.5}
      \begin{array}{ccccccccccccc}
                    0
        &=&         M'_0 + M_0  \cap M'_1
        &\moduleleq& M'_0 + M_1  \cap M'_1
        &\moduleleq& \dotsb
        &\moduleleq& M'_0 + M_n  \cap M'_1
        &(=&        M'_1)
        &  &        {}
        \\
                    {}
        &=&         M'_1 + M_0  \cap M'_2
        &\moduleleq& M'_1 + M_1  \cap M'_2
        &\moduleleq& \dotsb
        &\moduleleq& M'_1 + M_n  \cap M'_2
        &(=&        M'_2)
        &  &        {}
        \\
                    {}
        &\vdots&    {}
        & &         {}
        & &         {}
        & &         {}
        & &         {}
        & &         {}
        \\
                    {}
        &=&         M'_{n-1} + M_0  \cap M'_n
        &\moduleleq& M'_{n-1} + M_1  \cap M'_n
        &\moduleleq& \dotsb
        &\moduleleq& M'_{n-1} + M_n  \cap M'_n
        &(=&        M'_{n'})
        &=&         M \,.
      \end{array}
    \endgroup
  \]
  The modules in the first sequence are given by
  \[
              N_{ij}
    \defined  M_{i-1} + M'_j \cap M_i
  \]
  with $i = 1, \dotsc, n$, $j = 0, \dotsc, n'$, and the modules in the second sequence are given by
  \[
              N'_{ji}
    \defined  M'_{j-1} + M_i \cap M'_j \,,
  \]
  with $j = 1, \dotsc, n'$, $i = 0, \dotsc, n$.
  
  The factors of the first sequence are therefore given by
  \[
              F_{ij}
    \defined  N_{ij}/N_{i,j-1}
  \]
  for $i = 1, \dotsc, n$, $j = 1, \dotsc, n'$ together with the trivial factors
  \[
      N_{i0}/N_{i-1,n'}
    = M_{i-1}/M_{i-1}
    = 0
  \]
  for every $i = 2, \dotsc, n$.
  The factors of the second sequence are given by
  \[
              F'_{ji}
    \defined  N'_{ji}/N_{j,i-1}
  \]
  for $j = 1, \dotsc, n'$, $i = 1, \dotsc, n$ together with the trivial factors
  \[
      N'_{j0}/N'_{j-1,n}
    = M'_{j-1}/M'_{j-1}
    = 0
  \]
  for every $j = 2, \dotsc, n'$.
  It follows for all $i = 1, \dotsc, n$ and $j = 1, \dotsc, n'$ from the \hyperref[lemma: butterfly lemma]{butterfly~lemma} that
  \begin{align*}
            F_{ij}
    &=      N_{ij}/N_{i,j-1}  \\
    &=      (M_{i-1} + M'_j \cap M_i)/(M_{i-1} + M'_{j-1} \cap M_i)   \\
    &\cong  (M'_{j-1} + M_i \cap M'_j)/(M'_{j-1} + M_{i-1} \cap M'_j) \\
    &=      N_{ji}/N_{j,i-1}
     =      F'_{ji} \,.
  \end{align*}
  This shows that both sequences have the same non-trivial factors up to permutation and isomorphism.
  By removing all repetition from this sequences we thus arrive at two equivalent filtrations of $M$.
  These resulting filtrations are refinements of \eqref{equation: Schreier starting filtration one}, resp.\ \eqref{equation: Schreier starting filtration two} because the $M_i$ appear in the first sequence in the $M'_j$ appear in the second sequence.
\end{proof}





\subsection{The Jordan-Hölder Theorem}


\begin{fluff}
  We will now require the notion of a simple module, as introduced in Definition~\ref{definition: simple and maximal modules}.
\end{fluff}


\begin{definition}
  \label{definition: composition series}
  A filtration $(M_i)_{i=0}^n$ is a \emph{composition series} if all of its factors $M_i/M_{i-1}$ with $i = 1, \dotsc, n$ are simple.
  The factors of a composition series are its \emph{composition factors}.
\end{definition}


\begin{lemma}
  \label{lemma: preparation for jordan hoelder}
  Let $(M_i)_{i=0}^n$ be a composition series for $M$.
  \begin{enumerate}
    \item
      Every filtration which is equivalent to $(M_i)_{i=0}^n$ is again a composition series.
    \item
      The only refinement of $(M_i)_{i=0}^n$ is $(M_i)_{i=0}^n$ itself.
  \end{enumerate}
\end{lemma}


\begin{proof}
  \leavevmode
  \begin{enumerate}
    \item
      Every filtration of $M$ which is equivalent to $(M_i)_{i=0}^n$ has the same factors as $(M_i)_{i=0}^n$, which are then all simple.
    \item
      Let $(M_j)_{j=0}^{n'}$ be a refinement of $(M_i)_{i=0}^n$.
      For every $j = 0, \dotsc, n'$ there then exists some some $i = 1, \dotsc, n$ with $M_{i-1} \leq M'_j \leq M_i$.
      Then $M'_j/M_{i-1}$ is a submodule of the simple module $M_i/M_{i-1}$, and it follows that $M'_j/M_{i-1} = 0$ or $M'_j/M_{i-1} = M_i/M_{i-1}$.
      In the first case we have that $M'_j = M_{i-1}$ and in the second case we have that $M'_j = M_i$.
      
      This shows that every term of $(M_j)_{j=0}^{n'}$ already appers in $(M_i)_{i=0}^n$, which shows that $(M_j)_{j=0}^{n'} = (M_i)_{i=0}^n$.
    \qedhere
  \end{enumerate}
\end{proof}


\begin{theorem}[Jordan-Hölder]
  \label{theorem: jordan hoelder theorem}
  Suppose that $M$ admits a composition series.
  \begin{enumerate}
    \item
      Every filtration of $M$ has a refinements which is a composition series.
    \item
      Every two composition series of $M$ are equivalent.
  \end{enumerate}
\end{theorem}


\begin{proof}
  Let $(M_i)_{i=0}^n$ be a composition series for $M$.
  \begin{enumerate}
    \item
      Let $(M'_j)_{j=0}^{n'}$ be another filtration of $M$.
      Then $(M'_j)_{j=0}^{n'}$ and $(M_i)_{i=0}^n$ have equivalent refinements by \hyperref[theorem: Schreiers theorem]{Schreier’s theorem}.
      It follows from Lemma~\ref{lemma: preparation for jordan hoelder} that $(M'_j)_{j=0}^{n'}$ admits a refinements that is equivalent to $(M_i)_{i=0}^n$, and is therefore itself a composition serie.
    \item
      Let $(M'_j)_{j=0}^{n'}$ be another composition series of $M$.
      The above argument shows that $(M_i)_{i=0}^n$ and $(M'_j)_{j=0}^{n'}$ have equivalent refinements, which by Lemma~\ref{lemma: preparation for jordan hoelder} are just the compositions series themselves.
    \qedhere
  \end{enumerate}
\end{proof}


\begin{corollary}
  \label{corollary: consequences of jordan hoelder}
  \leavevmode
  \begin{enumerate}
    \item
      \label{enumerate: composition series have same length and factors}
      Every two composition series of $M$ have the same length, and up to permutation and isomorphism the same composition factors.
    \item
      \label{enumerate: filtration maximal length of composition series}
      If $M$ admits a composition series of length $n$ then every filtration of $M$ has at most length $n$.
    \item
      A filtration is a composition series if and only if it has maximal length among all filtrations.
  \end{enumerate}
\end{corollary}


\begin{proof}
  \leavevmode
  \begin{enumerate}
    \item
      This follows from the \hyperref[theorem: jordan hoelder theorem]{Jordan Hölder theorem}.
    \item
      This follows from the \hyperref[theorem: jordan hoelder theorem]{Jordan Hölder theorem}.
    \item
      If $(M_i)_{i=0}^n$ is a composition series of $M$ then every filtration $(M'_j)_{j=0}^{n'}$ of $M$ has a refinements $(M''_k)_{k=0}^{n''}$ which is equivalent to $M$.
      It follows with part~\ref*{enumerate: composition series have same length and factors} that $n = n'' \geq n'$.
      This shows that composition series have maximal length among all filtrations.
      
      If $M_i/M_{i-1}$ were not simple for some $i = 1, \dotsc, n$ then $M_i/M_{i-1}$ would have a nonzero proper submodule, which would then correspond to a proper submodule $N \moduleleq M_i$ with $M_{i-1} \moduleleq M_i$.
      Then
      \[
                    0
        =           M_0
        \modulelneq  M_1
        \modulelneq  \dotsb
        \modulelneq  M_{i-1}
        \modulelneq  N
        \modulelneq  M_i
        \modulelneq  \dotsb
        \modulelneq  M_n
        =           M
      \]
      is a refinement of $(M_i)_{i=0}^n$ of length $n+1$.
      Thus $(M_i)_{i=0}^n$ would not be a filtration of maximal length.
    \qedhere
  \end{enumerate}
\end{proof}


\begin{lemma}
  \label{lemma: artinian contains simple}
  Every nonzero artinian $R$-module contains a simple submodule.
\end{lemma}


\begin{proof}
  Suppose that $M$ is a nonzero artinian $R$-module which contains no simple submodule.
  Then $M \defines M_0$ is not simple itself and thus contains a nonzero proper submodule $M_1$, which must also not contain a simple submodule.
  This constructes inductivey a strictly decreasing sequence of submodules
  \[
                M
    =           M_0
    \modulegneq M_1
    \modulegneq M_2
    \modulegneq \dotsb
  \]
  which does not stabilize.
  This contradicts $M$ being artinian.
\end{proof}


\begin{proposition}
  The $R$-module $M$ has a composition series iff and only if it is both noetherian and artinian.
\end{proposition}


\begin{proof}
  Suppose that $M$ has a composition series of length $n$.
  Then every strictly increasing (resp.\ strictly decreasing) sequence of submodules of $M$ has at most length $n$ by Corollary~\ref{corollary: consequences of jordan hoelder}, part~\ref*{enumerate: filtration maximal length of composition series}.
  It follows that every strictly increasing (resp.\ strictly decreasing) sequence of submodule of $M$ stabilizies after at most $n$ steps.
  This shows that $M$ is both noetherian and artinian.
  
  Suppose that $M$ is both noetherian and artinian.
  If $M = 0$ then $M$ has a (unique) composition series of length $0$, so suppose that $M \neq 0$.
  It then follows that $M$ contains a simple submodule $M_1$ by Lemma~\ref{lemma: artinian contains simple}.
  If $M/M_1 = 0$ then $M = M_1$ and
  \[
                0
    =           M_0
    \modulelneq M_1
    =           M
  \]
  is a composition series of $M$.
  Otherwise the quotient $M/M_1$ is nonzero and again artinian by Proposition~\ref{proposition: noether artin ses} and thus contains a simple submodule.
  This simple submodule is then of the form $M_2/M_1$ for some submodule $M_2 \moduleleq M$ with $M_1 \modulelneq M_2$.
  
  If the above process terminates after $n$ steps then we arrive at a filtration
  \[
                0
    =           M_0
    \modulelneq M_1
    \modulelneq M_2
    \modulelneq \dotsb
    \modulelneq M_n
    =           M
  \]
  with simple factors $M_i/M_{i-1}$ for $i = 1, \dotsc, n$, i.e.\ at a composition series of $M$.
  Otherwise we would have constructed a strictly increasing sequence
  \[
                 0
    =            M_0
    \modulelneq  M_1
    \modulelneq  M_2
    \modulelneq  \dotsb
  \]
  which does not stabilize.
  But this contradicts $M$ being noetherian.
\end{proof}



% \begin{definition}
%   The \emph{length} of $M$ is
%   \[
%               \ell(M)
%     \defined  \sup  \{
%                 n \geq 0
%               \suchthat
%                 \text{$M$ admits a filtration of length $n$}
%               \} \,.
%   \]
%   If $\ell(M) < \infty$ then $M$ has \emph{finite length}.
% \end{definition}


% \begin{lemma}
%   The module $M$ has finite length if and only if it admits a composition series.
%   The length of $M$ is then coincides with the length of this (and such every) composition series.
% \end{lemma}
% 
% 
% \begin{proof}
%   The module $M$ has finite length if and only if admits a filtration $(M_i)_{i=0}^n$ of maximal length.
%   Then $(M_i)_{i=0}^n$ is a composition series of $M$ by Corollary~\ref{corollary: consequences of Jordan Hoelder}, and $\ell(M) = n$.
% \end{proof}
% 
% 
% \begin{definition}
%   If $M$ is a module of finite length, then the \emph{composition factors} of $M$ are the composition factors of its composition series.
% \end{definition}



