\subsection{Isotypical Components and Multiplicity Spaces}
\label{subsection: isotyipical components and multiplicity spaces}


\begin{conventions}
  In this subsection $R$ denotes a ring, $M, N$ denote $R$-modules and $E, F$ denote simple $R$-modules.
\end{conventions}





\subsubsection{Isotypical Components}


\begin{fluff}
  While every semisimple $R$-module $M$ can be decomposed into a direct sum of simple $R$-modules, this decomposition is generally not unique as seen in part~\ref*{enumerate: vector spaces are semisimple} of Example~\ref{example: semisimple modules}.
  We will now show that every semisimple module has a canonical decomposition into isotypical components.
\end{fluff}


\begin{definition}
  The \emph{$E$-isotypical component} of $M$ is
  \[
              M_E
    \defined  \sum_{\subalign{L &\moduleleq M \\ L &\cong E}} L \,.
  \]
  The module $M$ is \emph{$E$-isotypical} if $M = M_E$.
\end{definition}


\begin{lemma}
  The $E$-isotypical component $M_E$ is $E$-isotypical.
\end{lemma}


\begin{proof}
  We have that
  \[
      (M_E)_E
    = \sum_{\substack{L \moduleleq M_E \\ L \cong E}} L
    = \sum_{\subalign{L &\moduleleq M \\ L &\cong E}} L
    = M_E
  \]
  because every submodule $L \moduleleq M$ which is isomorphic to $E$ is contained in $M_E$.
\end{proof}


\begin{remark}
  The $E$-isotypical component $M_E$ is semisimple because it is a sum of simple $R$-modules.
  It follows that every $E$-isotypical module is semisimple.
\end{remark}


\begin{example}
  If $V$ is a representation of a group $G$, i.e.\ a $k[G]$-module, then $V^G$ is the isotypical component associated to the trivial irreducible representation.
  We have thus previously encountered the idea of isotypical components in Proposition~\ref{proposition: existence and uniqueness of Reynolds operators} when construction the Reynolds operator.
\end{example}


% TODO (optional): Add examples.


% TODO (optional): Warning: Not every element contained in a simple submodule, even for isotypical.


\begin{lemma}
  \label{lemma: intersection of semisimple sums}
  Let $N, N' \moduleleq M$ be semisimple submodules with $N = \sum_{i \in I} L_i$ and $N' = \sum_{j \in J} L'_j$ for simple submodules $L_i, L'_j \moduleleq M$.
  If $N \cap N' \neq 0$ then $L_i \cong L'_j$ for some $i \in I$, $j \in J$.
\end{lemma}


\begin{proof}
  The module $N \cap N'$ is again semisimple because it is a submodule of the semisimple modules $N, N'$.
  It follows from $N \cap N' \neq 0$ that $N \cap N'$ contains a simple module $L$.
  By applying Corollary~\ref{corollary: no nonzero homomorphisms between disjoint semisimple modules} to the inclusions $L \inclusion N$ and $L \inclusion N'$ it follows that $L \cong L_i$ and $L \cong L'_j$ for some $i \in I$, $j \in J$.
\end{proof}


\begin{definition}
  The set $\Irr(R)$ is the set of isomorphism classes of simple $R$-modules.
\end{definition}


\begin{remark}
  It follows from Corollary~\ref{corollary: simple modules are quotients by maximal ideals} that $\Irr(R)$ is indeed just a set, and not a proper class.
\end{remark}


\begin{remark}
  The isotypical component $M_E$ does only depend on the isomorphism class $[E] \in \Irr(R)$ of $E$.
\end{remark}


\begin{theorem}[Isotypical Decomposition]
  \label{theorem: isotypical decomposition}
  If $M$ is semisimple then
  \[
      M
    = \bigoplus_{[E] \in \Irr(R)} M_E \,,
  \]
  and if $M = \sum_{i \in I} L_i$ for simple submodules $L_i \moduleleq M$ then
  \[
      M_E
    = \sum_{\substack{i \in I \\ L_i \cong E}} L_i
  \]
  for every $[E] \in \Irr(R)$.
\end{theorem}


\begin{proof}
  We have that
  \[
              M
    =         \sum_{i \in I} L_i
    =         \sum_{[E] \in \Irr(R)}
              \underbrace{
                \sum_{\substack{i \in I \\ L_i \cong E}} L_i
              }_{\moduleleq M_E}
    \moduleleq \sum_{[E] \in \Irr(R)} M_E \,.
  \]
  It thus sufficies to show that the sum $M  = \sum_{[E] \in \Irr(R)} M_E$ is direct, i.e. that
  \[
          M_E
          \cap 
          \left(
            \sum_{\substack{[F] \in \Irr(R) \\ [F] \neq [E]}} M_F
          \right)
    \neq  0
  \]
  for every $[E] \in \Irr(R)$.
  This follows from Lemma~\ref{lemma: intersection of semisimple sums}.
\end{proof}


\begin{corollary}
  \label{corollary: isotypical components of isotypicial modules}
  If $M$ is $E$-isotypical and $F \ncong E$ then $M_F = 0$, i.e.\ if $L \moduleleq M$ is simple then $F \cong E$.
\end{corollary}


\begin{proof}
  The module $M$ is semisimple and the isotypical decomposition of $M$ is given by $M = M_E$.
  It follows that $M_F = 0$ for every $[F] \in \Irr(R)$ with $[F] \neq [E]$.
\end{proof}


\begin{lemma}
  If $N \moduleleq M$ is a submodule then $N_E = N \cap M_E$.
\end{lemma}


\begin{proof}
  It follows from $N \moduleleq M$ that $N_E \moduleleq M_E$ and therefore that $N_E \moduleleq N \cap M_E$.
  The module $N \cap M_E$ is a submodule of $M_E$ and therefore semisimple.
  For every simple submodule $L \moduleleq N \cap M_E \moduleleq M_E$ we have that $L \cong E$ by Corollary~\ref{corollary: isotypical components of isotypicial modules} and therefore $L \moduleleq N_E$.
  It follows that $N \cap M_E \moduleleq N_E$.
\end{proof}


\begin{corollary}
  If $M$ is $E$-isotypical then every submodule $N \moduleleq M$ is $E$-isotypical.
\end{corollary}


\begin{proof}
  We have that $N_E = N \cap M_E = N \cap M = N$.
\end{proof}


\begin{lemma}
  If $M$ is semisimple and $M = \bigoplus_{i \in I} L_i$ is a decomposition into simple submodules $L_i \moduleleq M$ then for every simple submodule $E \moduleleq M$ there then exists some $i \in I$ with $E \cong L_i$.
\end{lemma}


\begin{proof}[First proof]
  This follows from $0 \neq E \moduleleq M_E \moduleleq \bigoplus_{i \in I, L_i \cong E} L_i$.
\end{proof}


\begin{proof}[Second proof]
  Apply Corollary~\ref{corollary: no nonzero homomorphisms between disjoint semisimple modules} to the inclusion $E \inclusion M = \sum_{i \in I} L_i$.  
\end{proof}


\begin{lemma}
  \label{lemma: functoriality of isotypical components}
  Every homomorphism of $R$-modules $f \colon M \to N$ restrict to a homomorphism $f_E \colon M_E \to N_E$.
\end{lemma}


\begin{proof}
  For every simple submodule $L \moduleleq M$ the restriction $\restrict{f}{L}$ is either zero or injective, and it follows that either $f(L) = 0$ or $f(L) \cong L$.
  It follows that
  \[
                f(M_E)
    \moduleleq  f
                \left(
                  \sum_{\subalign{L &\moduleleq M \\ L &\cong E}} L
                \right)
    =           \sum_{\subalign{L &\moduleleq M \\ L &\cong E}} f(L)
    \moduleleq  \sum_{\subalign{L' &\moduleleq N \\ L' &\cong E}} L'
    =           N_E \,,
  \]
  which proves the claim.
\end{proof}


\begin{corollary}
  \label{corollary: endomorphism ring of semisimple module}
  If $M$ is semisimple, then the map
  \[
            \End_R(M)
    \to     \prod_{[E] \in \Irr(R)} \End_R(M_E),
    \quad   f
    \mapsto (f_E)_{[E] \in \Irr(R)}
  \]
  is a well-defined isomorphis of rings.
  If $R$ is a $k$-algebra, then it is an isomorphism of $k$-algebras.
\end{corollary}


\begin{proof}
  It follows from Lemma~\ref{lemma: functoriality of isotypical components} that every endomorphism $f \colon M \to M$ restrict for every $E \in \Irr(R)$ to an endomorphism $f_E \colon M_E \to M_E$.
  The statement therefore follows from Corollary~\ref{corollary: decomposition of endomorphism ring into product}.
\end{proof}





\subsubsection{Multiplicities of Simple Summands}


\begin{fluff}
  We know from linear algebra that for a $k$-vector space $V$ with $V \cong k^{\oplus I}$ the cardinality $|I|$ (i.e.\ the dimension of $V$) is unique.
  We will now show how this generalizes to semisimple modules.
\end{fluff}


\begin{lemma}
  \label{lemma: multiplicities for finite length}
  Let $M$ be semisimple and let
  \[
      M
    = L_1 \oplus \dotsb \oplus L_n
    = L'_1 \oplus \dotsb \oplus L'_{n'}
  \]
  be two decompositions into finitely many simple submodules $L_i, L'_j \moduleleq M$.
  Then this decomposition is unique up to permutation and isomorphism, i.e.\ it follows that $n = n'$ and there exists a bijection $\pi \colon \{1, \dotsc, n\} \to \{1, \dotsc, n'\}$ with $L'_{\pi(i)} \cong L_i$ for every $i = 1, \dotsc, n$.
\end{lemma}


\begin{proof}[First proof]
  We use the language of composition series (see Appendix~\ref{appendix: jordan hoelder}):
  Both decompositions give rise to composition series
  \[
                0
    \modulelneq  L_1
    \modulelneq  L_1 \oplus L_2
    \modulelneq  \dotsb
    \modulelneq  L_1 \oplus \dotsb \oplus L_n
    =           M
  \]
  and
  \[
                0
    \modulelneq  L'_1
    \modulelneq  L'_1 \oplus L'_2
    \modulelneq  \dotsb
    \modulelneq  L'_1 \oplus \dotsb \oplus L'_{n'}
    =           M
  \]
  with composition factors $L_i, L'_j$.
  The claim therefore follows from the \hyperref[theorem: jordan hoelder theorem]{Jordan--Hölder Theorem}.
\end{proof}


\begin{proof}[Second proof]
  Suppose that
  \[
          M
    \cong E_1^{\oplus n_1} \oplus \dotsb \oplus E_r^{\oplus n_r}
    \cong E_1^{\oplus n'_r} \oplus \dotsb \oplus E_r^{\oplus m_r}
  \]
  for simple, pairwise non-isomorphic $R$-modules $E_1, \dotsc, E_r$ and $n_i, m_i \geq 0$ for every $i = 1, \dotsc, r$.
  We need to show that $n_i = m_i$ for every $i = 1, \dotsc, r$.
  
  For every $i = 1, \dotsc, r$ we have that $M_{E_i} \cong E_i^{\oplus n_i}$ and $M_{E_i} \cong E_i^{\oplus m_i}$ by Theorem~\ref{theorem: isotypical decomposition}.
  It therefore sufficies to show that for every simple $R$-module $E$ and all $n, m \geq 0$ it follows from $E^{\oplus n} \cong E^{\oplus m}$ that $n = m$.
  
  Let $f \colon E^{\oplus n} \to E^{\oplus m}$ be an isomorphism of $R$-modules.
  Then for $D \defined \End_R(M)$ we may represent $f$ as a matrix $A \in \Mat(m \times n, D)$ and $f^{-1} \colon E^{\oplus m} \to E^{\oplus n}$ as a matrix $B \in \Mat(n \times m, D)$ (see Appendix~\ref{appendix: homomorphisms between direct sums} for a more detailed explanation on this).
  It then follows from $f \circ f^{-1} = \id_{E^{\oplus m}}$ and $f^{-1} \circ f = \id_{E^{\oplus n}}$ that $AB = I_n$ and $BA = I_m$.
  
  The matrix is $A$ is therefore invertible with $A^{-1} = B$.
  It follows that $A$ defines an isomorphism of right $D$-vector spaces $D^n \to D^{m}$ by left multiplication, from which it then further follows that $n = m$
\end{proof}


% TODO (optional): How do E^n and D^n relate to each other?


% \begin{proof}[Alternative proof]
%   The following proof is taken from \cite[XVII, \S 1, Proposition 1.2]{LangAlgebra2005}):
%   Suppose that
%   \[
%           M
%     \cong E_1^{n_1} \oplus \dotsb \oplus E_r^{n_r}
%     \cong E_1^{n'_r} \oplus \dotsb \oplus E_r^{n'_r}
%   \]
%   for simple, pairwise non-isomorphic $R$-modules $E_1, \dotsc, E_r$ and $n_i, n'_i \geq 0$ for all $i = 1, \dotsc, r$.
%   We need to show that $n_i = n'_i$ for all $i = 1, \dotsc, r$.
%   
%   For every $i = 1, \dotsc, r$ we have that $M_{E_i} \cong E_i^{n_i} \cong E_i^{n'_i}$ by Theorem~\ref{theorem: isotypical decomposition}.
%   It therefore sufficies to show that for every simple $R$-module $E$ and all $n, n' \geq 0$ it follows from $E^{\oplus n} \cong E^{\oplus n'}$ that $n \cong n'$.
%   
%   The endomorphism ring $D \defined \End_R(E)$ is a skew field by \hyperref[proposition: Schurs lemma]{Schur’s lemma} and it follows from Corollary~\ref{corollary: End is isomorphic to product of matrix rings Schur style} that
%   \[
%           \Mat_n(D)
%     \cong \End_R(E^{\oplus n})
%     \cong \End_R(E^{\oplus n'})
%     \cong \Mat_{n'}(D)
%   \]
%   as rings.
% \end{proof}


\begin{theorem}
  \label{theorem: multiplicity well-defined}
  Let $M$ be semisimple and let $M = \bigoplus_{i \in I} L_i = \bigoplus_{j \in J} L'_j$ be two decompositions into simple submodules $L_i, L'_j \moduleleq M$.
  Then for every simple $R$-module $E$ the sets
  \[
    \{ i \in I \suchthat L_i \cong E \}
    \quad\text{and}\quad
    \{ j \in J \suchthat L'_j \cong E \}
  \]
  have the same cardinality.
\end{theorem}


\begin{proof}
  We know from Theorem~\ref{theorem: isotypical decomposition} that
  \[
      M_E
    = \bigoplus_{\substack{i \in I \\ L_i \cong E}} L_i
    = \bigoplus_{\substack{j \in J \\ L_j \cong E}} L_j \,.
  \]
  We may therefore replace $M$ by $M_E$ and thus assume that $M$ is $E$-isotypical.
  We then have that $L_i, L'_j \cong E$ for all $i, j$, and we need to show that $\card{I} = \card{J}$.
  We make the following observation:
  
  \begin{claim}
    For every $j \in J$ there exists a finite subset $I' \subseteq I$ with $L'_j \moduleleq \bigoplus_{i \in I'} L_i$.
  \end{claim}
  
  \begin{proof}
    Let $y \in L'_j$ be nonzero.
    Then $y = \sum_{i \in I} x_i$ with $x_i \in L_i$ for every $i \in I$ and $x_i = 0$ for all but finitely many $i \in I$.
    It follows that there exists a finite subset $I' \subseteq I$ with $x \in \bigoplus_{i \in I'} L_i$.
    It follows from the simplicity of $L'_j$ that $x$ is a cylic generator of $L'_j$, and therefore that $L'_j \moduleleq \bigoplus_{i \in I'} L_i$.
  \end{proof}
  
  We now distinguish between four cases:
  \begin{itemize}
    \item 
      If $I$ and $J$ are both finite then the theorem follows from Lemma~\ref{lemma: multiplicities for finite length}.
    \item
      If $J$ is finite then by the above claim that there exists a finite subset $I' \subseteq I$ with $L'_j \moduleleq \bigoplus_{i \in I} L_i$ for every $j \in J$.
      It then follows that $M = \bigoplus_{i \in I'} L_i$ and therefore that $I = I'$.
      Then both $I, J$ are finite and the theorem follows from the first case.
    \item
      If $I$ is finite then we find in the same way as above that $J$ is finite and that the theorem follows from the first case.
    \item
      Suppose now that both $I$ and $J$ are infine.
      It follows from the above claim that there exists for every $j \in J$ some finite subset $I_j \subseteq I$ with $L'_j \moduleleq \bigoplus_{i \in I_j} L_i$.
      For $I' \defined \bigcup_{j \in J} I_j$ we then have that $L'_j \moduleleq \bigoplus_{i \in I'} L_i$ for every $j \in J$.
      It follows that $M = \bigoplus_{i \in I'} L_i$ and therefore that $I = I'$.
      Note that $I = I' = \bigcup_{j \in J} I_j$ has at most the cardinality of $J$ because $J$ is infinite and every $I_j$ is finite.
      
      This shows that $\card{I} \leq \card{J}$.
      It follows in the same way that $\card{J} \leq \card{I}$.
      Together this shows that $\card{I} = \card{J}$ by the theorem of Cantor--Schröder--Bernstein.
    \qedhere
  \end{itemize}
\end{proof}


\begin{remark}
  \label{remark: uniqueness of multiplicities alternative formulation}
  Theorem~\ref{theorem: multiplicity well-defined} can be reformulated as stating that there exists a bijection $\pi \colon I \to J$ with $L'_{\pi(i)} \cong L_i$ for every $i \in I$.
\end{remark}


\begin{definition}
  If $M = \bigoplus_{i \in I} L_i$ is any decomposition into simple submodules $L_i \moduleleq M$ then the cardinality of the set $\{i \in I \suchthat L_i \cong E\}$ is the \emph{multiplicity of $E$ in $M$}.
\end{definition}





\subsubsection{Multiplicity Spaces}


\begin{fluff}
  Another approach to both isotypical components and multiplicities is given by multiplicity spaces.
  For this we will require tensor products of modules, a nice introduction to which can be found in \cite[Chapter 10.4]{DummitFoote2004}.
\end{fluff}


\begin{fluff}
  \label{fluff: introducting multiplicity spaces}
  Every nonzero homomorphism $E \to M$ is injective by by \hyperref[proposition: schurs lemma for modules]{Schur’s Lemma}, so we may think about $\Hom_R(E,M)$ as the space of all embeddings $E \to M$ (together with the zero homomorphism).
  The images $f(E)$ of the various embeddings $f \in \Hom_R(E,M)$ are precisely those submodules of $M$ which are isomorphic to $E$, the sum of which is the $E$-isotypical component $M_E$.
  Hence, if we consider the evaluation map
  \begin{equation}
    \label{equation: raw evalution map for multiplicity spaces}
            \Hom_R(M,E) \times E
    \to     M,
    \quad   (f, e)
    \mapsto f(e) \,,
  \end{equation}
  then the image of the induced map
  \[            
            \Hom_R(E,M) \tensor_\Integer E
    \to     M,
    \quad   f \tensor e
    \mapsto f(e) \,,
  \]
  is precisely the $E$-isotypical component $M_E$.
  But this map will in general not be injective, which we can fix by tensoring over $\End_R(E)$ instead of $\Integer$:
  
  We also know from \hyperref[proposition: schurs lemma for modules]{Schur’s Lemma} that the endomorphism ring $D \defined \End_R(E)$ is a skew field.
  The $R$-module $E$ is also a left $D$-vector space via
  \[
      \varphi \cdot e
    = \varphi(e)
  \]
  for all $\varphi \in D$, $e \in E$.
  This also induces a right $D$-vector space structure on the $\Hom_R(E,M)$ via precomposition, i.e.\ via
  \[
      f \cdot \varphi
    = f \circ \varphi
  \]
  for all $f \in \Hom_R(E,M)$, $\varphi \in D$.
  The evaluation map~\eqref{equation: raw evalution map for multiplicity spaces} is $D$-balenced and thus induces a well-defined additive map
  \[
            \Hom_R(E,M) \tensor_D E
    \to     M,
    \quad   f \tensor e
    \mapsto f(e) \,,
  \]
  whose image is again the $E$-isotypical component $M_E$.
  
  The abelian group $\Hom_R(E,M) \tensor_D E$ inherits the structure of a left $R$-module from $E$ via
  \[
      r \cdot (f \tensor e)
    = f \tensor (r e)
  \]
  for all $r \in R$ and simple tensors $f \tensor e \in \Hom_R(E,M) \tensor_D E$.
  Indeed, the actions of $R$ and $D$ on $E$ commute in the sense that
  \[
      \varphi \cdot (r \cdot e)
    = r \cdot (\varphi \cdot e)
  \]
  for all $r \in R$, $\varphi \in D$, $e \in E$ by definition of $D$.
  Hence $E$ carries the structure of an $D$-$R^\op$-bimodule via
  \[
      \varphi \cdot e \cdot r^\op
    = \varphi \cdot (r \cdot e)
    = r \cdot (\varphi \cdot e)
  \]
  for all $r \in R$, $\varphi \in D$, $e \in E$.
  This then endows $\Hom_R(E,M) \tensor_D E$ with the structure of a right $R^\op$-module via
  \[
      (f \tensor e) \cdot r^\op
    = f \tensor (e \cdot r^\op)
    = f \tensor (r e)
  \]
  for all $r \in R$.
  The corresponding left $R$-module structure is then as claimed.
\end{fluff}


\begin{definition}
  The right $\End_R(E)$-vector space $\Hom_R(E,M)$ is the \emph{multiplicity space}\footnote{
  The author has taken this term from \cite{AP2012DoubleCommutant} and does not know how common its usage is.
  } of $M$ with respect to $E$.
\end{definition}


\begin{proposition}
  \label{proposition: multiplicity spaces}
    Let $D \defined \End_R(E)$.
    \begin{enumerate}
    \item
      \label{enumerate: one-dimensional as D vector space}
      If $F \cong E$ then the multiplicity space $\Hom_R(E,F)$ is one-dimensional as a right $D$-vector space.
    \item
      \label{enumerate: basis of multiplicity space}
      Let $M_E = \bigoplus_{i \in I} L_i$ be a decomposition into simple $R$-module, each of which (necessarily) isomorphic to $E$.
      For every $i \in I$ let $\tilde{f}_i \colon E \to L_i$ be an isomorphism of $R$-modules and let $f_i \colon E \to M$ be the extension of $\tilde{f}_i$ to a homomorphism $E \to M$.
      Then the family $(f_i)_{i \in I}$ is a right $D$-basis for $\Hom_R(E,M)$.
    \item
      The evaluation map
      \[
                \Phi
        \colon  \Hom_R(E,M) \tensor_D E
        \to     M_E,
        \quad   f \tensor e
        \mapsto f(e)
      \]
      is an isomorphism of $R$-modules.
  \end{enumerate}
\end{proposition}


\begin{proof}
  \leavevmode
  \begin{enumerate}
    \item
      Any isomorphism of $R$-modulen $f \colon F \to E$ induces an isomorphism of right $D$-vector spaces
      \[
                              \Hom_R(E,F)
        \xlongrightarrow{f_*} \Hom_R(E,E)
        =                     D \,.
      \]
    \item
      The inclusion $\iota \colon M_E \to M$ induces an isomorphism of right $D$-vector spaces
      \[
                                  \Hom_R(E, M_E)
        \xlongrightarrow{\iota_*} \Hom_R(E, M) \,.
      \]
      For every $i \in I$ let $\pi_i \colon M_E \to L_i$ be the projection along this decomposition and for every $f \in \Hom_R(E,M_E)$ let $f_i \defined \pi_i \circ f$ be the $i$-th component of $f$.
      It follows from $E$ being cyclic (and thus finitely generated) that the map
      \[
              \Hom_R(E, M_E)
        =     \Hom_R\left(E, \bigoplus_{i \in I} L_i \right)
        \xlongrightarrow{f \mapsto (f_i)_{i \in I}}
              \bigoplus_{i \in I} \Hom_R(E, L_i)
      \]
      is an isomorphism of abelian groups (by Lemma~\ref{lemma: hom is additive for fg modules}).
      This is also an isomorphism of right $D$-vector spaces, so it follows altogether that
      \[
              \Hom_R(E, M)
        \cong \Hom_R(E, M_E)
        =     \Hom_R\left( E, \bigoplus_{i \in I} L_i \right)
        \cong \bigoplus_{i \in I} \Hom_R(E, L_i)
      \]
      as right $D$-vector spaces.
      For every $i \in I$ the element $\tilde{f}_i \in \Hom_R(E, L_i)$ is a right $D$-basis by part~\ref*{enumerate: one-dimensional as D vector space}, and under the above isomorphism the resulting right $D$-basis $(\tilde{f}_i)_{i \in I}$ of $\bigoplus_{i \in I} \Hom_R(E, L_i)$ corresponds to the family $(f_i)_{i \in I}$ in $\Hom_R(E,M)$, which is therefore also a right $D$-basis.
    \item
      It follows that from part~\ref*{enumerate: basis of multiplicity space} that
      \[
          \Hom_R(E, M) \tensor_D E
        = \left( \bigoplus_{i \in I} f_i D \right) \tensor_D E
        = \bigoplus_{i \in I} (f_i D) \tensor_D E
        = \bigoplus_{i \in I} (f_i \tensor E) \,.
      \]
      Observe that $\Phi$ maps the summand $f_i \tensor E$ onto the summand $f_i(E) = L_i$ and because $f_i$ is an isomorphism it does so bijectively.
      (Here we use that $D$ a skew field:
      The map $E \to \Hom_R(E, M) \tensor_D E$, $e \mapsto f_i \tensor e$ is injective because $\Hom_R(E,M)$ is free as a right $D$-module.)
      It follows that $\Phi \colon \bigoplus_{i \in I} (f_i \tensor_D E) \to \bigoplus_{i \in I} L_i$ is also bijective.
      
      For all $r \in R$ and simple tensors $f \tensor e \in \Hom_R(E,M) \tensor_D E$ we have that
      \[
          \Phi(r \cdot (f \tensor e))
        = \Phi(f \tensor (re))
        = f(re)
        = r f(e)
        = r \, \Phi(f \tensor e) \,,
      \]
      which shows that $\Phi$ is an isomorphism of $R$-modules.
    \qedhere
  \end{enumerate}
\end{proof}


\begin{corollary}
  \label{corollary: dimension of multiplicity space is multiplicity}
  The $\End_R(E)$-dimension of $\Hom_R(E,M)$ is given by the multiplicity of $E$ in $M$.
\end{corollary}


\begin{corollary}
  If $M$ is semisimple then the map
  \[
            \bigoplus_{[E] \in \Irr(R)} \Hom_R(E, M) \tensor_{\End_R(E)} E
    \to     M \,,
    \quad   f \tensor e
    \mapsto f(e)
  \]
  is an isomorphism of $R$-modules, where $R$ acts on $\Hom_R(E, M) \tensor_{\End_R(E)} E$ via
  \[
      r \cdot (f \tensor e)
    = f \tensor (re)
  \]
  for all $r \in R$ and simple tensors $f \tensor e \in \Hom_R(E, M) \tensor_{\End_R(E)} E$.
\end{corollary}




